databases:
  - name: german-learning-db
    databaseName: german_learning
    user: german_user
services:
  - type: web
    name: verb-end-torture-chamber
    runtime: python
    plan: free
    buildCommand: pip install -r requirements.txt
    startCommand: gunicorn app:app
    disk:
      name: german-learning-data
      mountPath: /data
      sizeGB: 1
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: german-learning-db
          property: connectionString
      - key: SECRET_KEY
        generateValue: true
      - key: API_TOKEN
        generateValue: true
      - key: BASE_URL
        value: https://verb-end-torture-chamber.onrender.com
      - key: DB_PATH
        value: /opt/render/project/src/german_app.db
    healthCheckPath: /
    autoDeploy: true

  # Optional: cron job for daily notifications
  # Uncomment after deploying the web service and setting BASE_URL
  # - type: cron
  #   name: daily-notification
  #   runtime: python
  #   schedule: "0 6 * * *"  # 6 AM UTC daily
  #   buildCommand: pip install requests
  #   startCommand: |
  #     python -c "
  #     import requests, os
  #     url = os.environ['BASE_URL'] + '/api/daily/send'
  #     token = os.environ['API_TOKEN']
  #     r = requests.post(url, headers={'Authorization': f'Bearer {token}'})
  #     print(r.json())
  #     "
  #   envVars:
  #     - key: BASE_URL
  #       fromService:
  #         name: verb-end-torture-chamber
  #         type: web
  #         envVarKey: BASE_URL
  #     - key: API_TOKEN
  #       fromService:
  #         name: verb-end-torture-chamber
  #         type: web
  #         envVarKey: API_TOKEN
